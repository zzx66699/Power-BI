## 📘 DATEADD()

### 🧩 语法
```DAX
DATEADD(<dates>, <number_of_intervals>, <interval>)
```

### 📖 参数说明
| 参数 | 说明 |
|------|------|
| `<dates>` | 日期列（通常为 `'Date'[Date]`）。 |
| `<number_of_intervals>` | 要偏移的时间间隔数量，可为正（向后）或负（向前）。 |
| `<interval>` | 时间单位。可取以下关键字：`DAY`、`MONTH`、`QUARTER`、`YEAR`。 |

---

### 💡 功能说明
`DATEADD()` 返回一个**日期表**，  
> 表示在 `<dates>` 的当前筛选上下文基础上，沿时间轴偏移 `<number_of_intervals>` 个 `<interval>` 单位后得到的日期集合。  
> 用于将当前日期上下文向前或向后移动指定的时间间隔（天、月、季度、年），  
> 常用于同比、环比、前期比较等分析。

---

### 📊 示例 

#### 示例 1️⃣：✅ 合法的连续日期表：
| Date       |
| ---------- |
| 2025-01-01 |
| 2025-01-02 |
| 2025-01-03 |
| 2025-01-04 |
| 2025-01-05 |

#### 示例 2️⃣：❌ 非连续（会导致 DATEADD() 报错或返回不完整结果）：
| Date       |              |
| ---------- | ------------ |
| 2025-01-01 |              |
| 2025-01-03 | ← 缺了 1 月 2 日 |
| 2025-01-05 | ← 缺了 1 月 4 日 |

> DATEADD() 要求传入的日期列（通常 'Date'[Date]）是连续的日期序列，否则函数会报错 “The date table must contain contiguous dates”  
> 因为 DATEADD() 的工作方式是：按“位置偏移”计算时间上下文（而不是按日期差值）。
> 它是通过匹配日期表中的实际日期实现的。如果日期表中缺了某天或某月，DAX 就无法确定“往前一个月的日期集合”是什么。于是要么报错，要么丢失结果。
---

#### 示例 3️⃣： 与 CALCULATE 结合使用（去年同期销售）
```DAX
Sales Last Year :=
CALCULATE(
    [Total Sales],
    DATEADD('Date'[Date], -1, YEAR)
)
```

👉 对每个时间上下文（例如某月或某日），  
返回“往前一年”的同日期范围的销售额。  
这是 DAX 中实现同比（YoY）的常见写法。

---

### ⚙️ 与 DATESINPERIOD 的区别

| 函数 | 行为 | 返回 |
|------|------|------|
| `DATEADD()` | 将当前上下文整体平移固定间隔 | “相同形状”的日期集（如整月、整年） |
| `DATESINPERIOD()` | 从一个起点延伸一段时间跨度 | 连续时间段（可跨多月） |

🔹 简而言之：  
- `DATEADD` = “平移”上下文  
- `DATESINPERIOD` = “拉伸”时间范围

---
### 🧩 与其它函数对比
| 函数                     | 是否要求连续日期表 | 说明              |
| ---------------------- | --------- | --------------- |
| `DATEADD()`            | ✅ 必须连续    | 用位置偏移计算         |
| `SAMEPERIODLASTYEAR()` | ✅ 必须连续    |   |
| `DATESINPERIOD()`      | ❌ 不强制     | 按日期区间过滤，只看存在的日期 |
| `DATESBETWEEN()`       | ❌ 不强制     | 只返回范围内存在的日期     |
| `DATESYTD()`           | ✅ 建议连续    | 结果会更精确（否则中断）    |


---

| 函数名称 | 含义 | 等价的 `DATEADD()` 写法 |
|-----------|--------|--------------------------|
| `NEXTDAY(<dates>)` | 返回当前日期的**下一天** | `DATEADD(<dates>, 1, DAY)` |
| `PREVIOUSDAY(<dates>)` | 返回当前日期的**前一天** | `DATEADD(<dates>, -1, DAY)` |


