## 📘 DATESBETWEEN()

### 🧩 语法
```DAX
DATESBETWEEN(<dates>, <start_date>, <end_date>)
```

### 📖 参数说明
| 参数 | 说明 |
|------|------|
| `<dates>` | 日期列（通常为 `'Date'[Date]`）。 |
| `<start_date>` | 起始日期，定义范围的开始。 |
| `<end_date>` | 结束日期，定义范围的结束。 |

---

### 💡 功能说明
- `DATESBETWEEN()` 返回一个**日期表**，包含 `<dates>` 列中介于 `<start_date>` 与 `<end_date>` 之间的所有日期（包括起止边界）。  
- 日期必须存在于 `<dates>` 列中；若日期表中缺天，返回结果也会缺对应日期。
- <start_date> 可以写BLANK()，表示在first date in the date column
  
---

### 🧠 常见用途
| 用途 | 示例 |
|------|------|
| 计算自定义时间段的销售 | `CALCULATE([Sales], DATESBETWEEN(...))` |
| 定义滚动区间（如最近 30 天） | `DATESBETWEEN('Date'[Date], TODAY()-30, TODAY())` |
| 自定义财务报告周期 | `DATESBETWEEN('Date'[Date], [FiscalStart], [FiscalEnd])` |

---
### 📊 示例

假设 `'Date'[Date]` 包含以下日期：

| Date |
|------|
| 2025-01-01 |
| 2025-01-02 |
| 2025-01-04 |
| 2025-01-05 |

#### 示例 1
```DAX
DATESBETWEEN('Date'[Date], DATE(2025,1,2), DATE(2025,1,4))
```
返回的表为：
| Date       |
| ---------- |
| 2025-01-02 |
| 2025-01-04 |

> 只会返回 'Date'[Date] 中所有满足2025-01-02 ≤ Date ≤ 2025-01-04 的行。

---
#### 示例 2
```DAX
DATESBETWEEN('Date'[Date], DATE(2025,1,6), DATE(2025,1,10))
```
返回的表为：
| Date    |
| ------- |
| *(无数据)* |

---

#### 示例 3：结合 CALCULATE 使用
```DAX
Sales Jan 2–4 :=
CALCULATE(
    [Total Sales],
    DATESBETWEEN('Date'[Date], DATE(2025,1,2), DATE(2025,1,4))
)
```
👉 返回 2025-01-02 到 2025-01-04 之间的销售总额。

---

#### 示例 3：计算当前筛选上下文情况下的累计客户数量

样本 Sales 表

| Date       | CustomerKey | SalesAmount |
|-------------|--------------|-------------|
| 2025-01-01  | C001         | 120 |
| 2025-01-01  | C002         | 150 |
| 2025-01-02  | C001         | 80 |
| 2025-01-02  | C003         | 100 |
| 2025-01-03  | C004         | 200 |
| 2025-01-04  | C002         | 60 |
| 2025-01-05  | C005         | 90 |
| 2025-01-05  | C006         | 110 |
| 2025-01-06  | C004         | 50 |
| 2025-01-06  | C007         | 70 |
```DAX
Customers LTD =
VAR CustomersLTD =
    CALCULATE(
        DISTINCTCOUNT(Sales[CustomerKey]),
        DATESBETWEEN(
            'Date'[Date],
            BLANK(), #first date in the date column
            MAX('Date'[Date]) #the last date in filter context
        )
    )
RETURN
    CustomersLTD
```

我们按日期逐步计算 “截至该日期的累计客户数”：

| Date | 当日新客户 | 累计客户（Customers LTD） | 说明 |
|------|--------------|-----------------------------|------|
| 2025-01-01 | C001, C002 | 2 | 第一天共 2 个独立客户 |
| 2025-01-02 | C003 | 3 | 新增 1 个客户 (C003)，累计 3 |
| 2025-01-03 | C004 | 4 | 新增 1 个客户 (C004)，累计 4 |
| 2025-01-04 | — | 4 | 没有新客户，累计不变 |
| 2025-01-05 | C005, C006 | 6 | 新增 2 个客户，累计 6 |
| 2025-01-06 | C007 | 7 | 新增 1 个客户，累计 7 |


最后返回的结果表

| Date | Customers LTD |
|------|----------------|
| 2025-01-01 | 2 |
| 2025-01-02 | 3 |
| 2025-01-03 | 4 |
| 2025-01-04 | 4 |
| 2025-01-05 | 6 |
| 2025-01-06 | 7 |

这张表表示：
> 截至 2025-01-06，公司共累计拥有 **7 个独立客户**  
> （C001~C007），而不是每日新客户之和。

💡 在 Power BI 报表中，你通常会用：
- **X 轴**：`Date`  
- **Y 轴**：`Customers LTD`  
来绘制一条“累计客户增长曲线”，如下所示：

```
客户数
│
│              ▓
│          ▓
│        ▓
│     ▓
│  ▓
└──────────────────────▶ 时间
   1/1  1/2  1/3  1/4  1/5  1/6
```
